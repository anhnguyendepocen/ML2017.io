<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Philipp Broniecki and Lucas Leemann – Machine Learning 1K" />


<title>Lab 6 – Regularization</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Essex 2017 Machine Learning</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day1.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D1%20-%20Intro%20ML.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions1.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day2.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D2%20-%20Intro%20ML.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions2.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day3.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D3%20-%20Classification.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions3.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day4.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D4%20-%20Resampling.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions4.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 5
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day5.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D5%20-%20Model%20Selection%20I.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions5.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 6
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day6.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D6%20-%20Model%20Selection%20II.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions6.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 7
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day7.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D7%20-%20Polynomial%20Models.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions7.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 8
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day8.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D8%20-%20Tree-Based%20Methods.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions8.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 9
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day9.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D9%20-%20Unsupervised%20Learning.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions9.html">Solutions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab 6 – Regularization</h1>
<h4 class="author"><em>Philipp Broniecki and Lucas Leemann – Machine Learning 1K</em></h4>

</div>


<div id="based-on-james-et-al.-2013-chapter-6" class="section level5">
<h5>(based on James et al. 2013, chapter 6)</h5>
</div>
<div id="ridge-regression-and-the-lasso" class="section level3">
<h3>Ridge Regression and the Lasso</h3>
<p>We start by clearing our workspace, loading the foreigners data, and doing the necessary variable manipulations.</p>
<pre class="r"><code># clear workspace
rm(list=ls())

# load foreigners data
load(&quot;your directory/BSAS_manip.RData&quot;)
head(data2)

# we declare the factor variables
data2$urban &lt;- factor(data2$urban, labels = c(&quot;rural&quot;, &quot;more rural&quot;, &quot;more urban&quot;, &quot;urban&quot;))
data2$RSex &lt;- factor(data2$RSex, labels = c(&quot;Male&quot;, &quot;Female&quot;))
data2$health.good &lt;- factor(data2$health.good, labels = c(&quot;bad&quot;, &quot;fair&quot;, &quot;fairly good&quot;, &quot;good&quot;) )</code></pre>
<p>In order to run ridge regression, we create a matrix from our dataset using the <code>model.matrix()</code> function. We also need to remove the intercept from the resulting matrix because the function to run ridge regression automatically includes one. Furthermore, we will use the subjective rate of immigrants as response. Consequently, we have to remove <code>over.estimate</code> as it measures the same thing. Otherwise, it would be somewhat similar to predicting height measured in inches using as a predictor whether the person is taller than 70 inches. Lastly, the party affiliation dummies are mutually exclusive, se we have to exclude the model category <code>Cons</code>.</p>
<pre class="r"><code># covariates in matrix form
x &lt;- model.matrix(IMMBRIT ~ ., data2)

# drop the intercept and over.estimate &amp; Cons
drop &lt;- which(colnames(x) %in% (c(&quot;(Intercept)&quot;, &quot;over.estimate&quot;, &quot;Cons&quot;)))
x &lt;- x[, -drop]
# check if it looks fine
head(x)</code></pre>
<pre><code>##   RSexFemale RAge Househld Lab SNP Ukip BNP GP party.other paper
## 1          0   50        2   1   0    0   0  0           0     0
## 2          1   18        3   0   0    0   0  0           1     0
## 3          1   60        1   0   0    0   0  0           1     0
## 4          1   77        2   0   0    0   0  0           1     1
## 5          1   67        1   0   0    0   0  0           1     0
## 6          0   30        4   0   0    0   0  0           1     1
##   WWWhourspW religious employMonths urbanmore rural urbanmore urban
## 1          1         0           72               0               0
## 2          4         0           72               0               0
## 3          1         0          456               0               1
## 4          2         1           72               0               0
## 5          1         1           72               0               1
## 6         14         0           72               0               0
##   urbanurban health.goodfair health.goodfairly good health.goodgood HHInc
## 1          1               1                      0               0    13
## 2          1               0                      1               0     3
## 3          0               0                      0               1     9
## 4          0               0                      0               1     8
## 5          0               0                      0               1     9
## 6          0               0                      1               0     9</code></pre>
<pre class="r"><code># response vector
y &lt;- data2$IMMBRIT</code></pre>
<div id="ridge-regression" class="section level4">
<h4>Ridge Regression</h4>
<p>The <code>glmnet</code> package provides functionality to fit ridge regression and lasso models. We load the package and call <code>glmnet()</code> to perform ridge regression.</p>
<pre class="r"><code>library(glmnet)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## foreach: simple, scalable parallel programming from Revolution Analytics
## Use Revolution R for scalability, fault tolerance and more.
## http://www.revolutionanalytics.com</code></pre>
<pre><code>## Loaded glmnet 2.0-10</code></pre>
<pre class="r"><code># tuning parameter
grid &lt;- 10^seq(4, -2, length = 100)
plot(grid, bty = &quot;n&quot;, pch = 19,
     main = expression(paste(&quot;Grid of Tuning Parameters &quot;, lambda)))</code></pre>
<p><img src="day6_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># run ridge; alpha = 0 means do ridge
ridge.mod &lt;- glmnet(x, y, alpha = 0, lambda = grid)

# coefficient shrinkage visualized
plot(ridge.mod, xvar = &quot;lambda&quot;, label = TRUE)</code></pre>
<p><img src="day6_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code># a set of coefficients for each lambda
dim(coef(ridge.mod))</code></pre>
<pre><code>## [1]  21 100</code></pre>
<p>We can look at the coefficients at different values for <span class="math inline">\(\lambda\)</span>. Here, we randomly choose two different values and notice that smaller values of <span class="math inline">\(\lambda\)</span> result in larger coefficient estimates and vice-versa.</p>
<pre class="r"><code># Lambda and Betas
ridge.mod$lambda[80]</code></pre>
<pre><code>## [1] 0.1629751</code></pre>
<pre class="r"><code>coef(ridge.mod)[, 80]</code></pre>
<pre><code>##            (Intercept)             RSexFemale                   RAge 
##           39.032833601            7.099569260           -0.077723547 
##               Househld                    Lab                    SNP 
##            1.693057342           -4.221028234            3.322375300 
##                   Ukip                    BNP                     GP 
##           -5.770869931            8.988511673           -4.785054788 
##            party.other                  paper             WWWhourspW 
##           -0.493813961            2.351267144           -0.042205976 
##              religious           employMonths        urbanmore rural 
##            0.032847310            0.003402161            0.174072630 
##        urbanmore urban             urbanurban        health.goodfair 
##            1.611492994            3.189323208           -1.160999582 
## health.goodfairly good        health.goodgood                  HHInc 
##            0.109245639            0.597683773           -1.595986498</code></pre>
<pre class="r"><code>sqrt( sum(coef(ridge.mod)[-1, 80]^2) )</code></pre>
<pre><code>## [1] 15.55516</code></pre>
<pre class="r"><code>ridge.mod$lambda[40]</code></pre>
<pre><code>## [1] 43.28761</code></pre>
<pre class="r"><code>coef(ridge.mod)[, 40]</code></pre>
<pre><code>##            (Intercept)             RSexFemale                   RAge 
##           32.397820379            2.545342557           -0.018759752 
##               Househld                    Lab                    SNP 
##            0.310894459           -0.650535855            1.683631453 
##                   Ukip                    BNP                     GP 
##           -1.486092735            4.138393345           -1.297450544 
##            party.other                  paper             WWWhourspW 
##            0.464851984            0.295693655           -0.016130971 
##              religious           employMonths        urbanmore rural 
##            0.348265533           -0.004899983           -0.323446701 
##        urbanmore urban             urbanurban        health.goodfair 
##            0.232753980            1.046907693           -0.152239958 
## health.goodfairly good        health.goodgood                  HHInc 
##            0.002537239           -0.328775171           -0.472606701</code></pre>
<pre class="r"><code>sqrt(sum(coef(ridge.mod)[-1, 40]^2))</code></pre>
<pre><code>## [1] 5.734655</code></pre>
<p>We can get ridge regression coefficients for any value of <span class="math inline">\(\lambda\)</span> using predict.</p>
<pre class="r"><code># compute coefficients at lambda = s
predict(ridge.mod, s = 50, type = &quot;coefficients&quot;)[1:21, ]</code></pre>
<pre><code>##            (Intercept)             RSexFemale                   RAge 
##           32.102065777            2.316842251           -0.016749575 
##               Househld                    Lab                    SNP 
##            0.272887080           -0.575654158            1.522106250 
##                   Ukip                    BNP                     GP 
##           -1.351681901            3.775662599           -1.179527530 
##            party.other                  paper             WWWhourspW 
##            0.432557099            0.247647849           -0.014851506 
##              religious           employMonths        urbanmore rural 
##            0.327572876           -0.004676662           -0.304256829 
##        urbanmore urban             urbanurban        health.goodfair 
##            0.206429903            0.961831864           -0.120177346 
## health.goodfairly good        health.goodgood                  HHInc 
##            0.008647552           -0.318723921           -0.428000409</code></pre>
<p>Next, we can use cross-validation on ridge regression by first splitting the dataset into training and test subsets.</p>
<pre class="r"><code># cross-validate lambda by splitting dataset into training and test
set.seed(1)
train &lt;- sample(1:nrow(x), nrow(x) * .5)
y.test &lt;- y[-train]</code></pre>
<p>We estimate the parameters with <code>glmnet()</code> over the training set and predict the values on the test set to calculate the validation error.</p>
<pre class="r"><code># fit on training set
ridge.m &lt;- glmnet(x[train, ], y[train], alpha = 0, lambda = grid, thresh = 1e-12)

# predict with lambda = 4
ridge.p &lt;- predict(ridge.m, s = 4, newx = x[-train, ])

# MSE on test data
mean( (ridge.p - y.test)^2 )</code></pre>
<pre><code>## [1] 397.5339</code></pre>
<pre class="r"><code># maximal error?
mean( (mean(y[train]) - y.test)^2)</code></pre>
<pre><code>## [1] 469.0082</code></pre>
<p>In the previous example, we used <span class="math inline">\(\lambda=4\)</span> when evaluating the model on the test set. We can use a large value for <span class="math inline">\(\lambda\)</span> and see the difference in mean error.</p>
<pre class="r"><code># try for large lambda
ridge.p2 &lt;- predict(ridge.m, s = 1e+4, newx = x[-train, ])
mean((ridge.p2 - y.test)^2)</code></pre>
<pre><code>## [1] 468.7094</code></pre>
<p>We can also compare the results with a least squares model where <span class="math inline">\(\lambda = 0\)</span>.</p>
<pre class="r"><code># compare to standard logistic regression where lambda is 0
ridge.p &lt;- predict(ridge.m, s = 0, newx = x[-train, ], exact = TRUE)
mean( (ridge.p - y.test)^2 )</code></pre>
<pre><code>## [1] 398.0469</code></pre>
<pre class="r"><code># standard lm
lm.data &lt;- data.frame(IMMBRIT = y, x)
lm.m &lt;- lm(IMMBRIT ~ ., data = lm.data, subset = train)
lm.p &lt;- predict(lm.m, newdata = lm.data[-train,])
mean( (lm.p - y.test)^2 )</code></pre>
<pre><code>## [1] 398.0471</code></pre>
<p>We can choose different values for <span class="math inline">\(\lambda\)</span> by running cross-validation on ridge regression using <code>cv.glmnet()</code>.</p>
<pre class="r"><code>set.seed(1)
# training data for CV to find optimal lambda, but then test data to estimate test error
cv.out &lt;- cv.glmnet(x[train, ], y[train], alpha = 0)
plot(cv.out)</code></pre>
<p><img src="day6_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code># best performing model&#39;s lambda value
bestlam &lt;- cv.out$lambda.min
bestlam</code></pre>
<pre><code>## [1] 4.661975</code></pre>
<p>The best performing model is the one with <span class="math inline">\(\lambda = 4.661975\)</span></p>
<pre class="r"><code># predict outcomes using best cross-validated lambda
ridge.pred &lt;- predict(ridge.mod, s = bestlam, newx = x[-train, ])
mean((ridge.pred - y.test)^2)</code></pre>
<pre><code>## [1] 382.9461</code></pre>
<p>Finally, we run ridge regression on the full dataset and examine the coefficients for the model with the best MSE.</p>
<pre class="r"><code># ridge on full data
out &lt;- glmnet(x, y, alpha = 0)
predict(out, type = &quot;coefficients&quot;, s = bestlam)[1:21, ]</code></pre>
<pre><code>##            (Intercept)             RSexFemale                   RAge 
##           37.108971018            5.975675191           -0.058243019 
##               Househld                    Lab                    SNP 
##            1.201411861           -2.627752811            3.595667572 
##                   Ukip                    BNP                     GP 
##           -4.050571927            8.659645549           -3.425693921 
##            party.other                  paper             WWWhourspW 
##            0.322628218            1.634179295           -0.033874988 
##              religious           employMonths        urbanmore rural 
##            0.310882881           -0.001570349           -0.260126816 
##        urbanmore urban             urbanurban        health.goodfair 
##            0.941168677            2.370721191           -1.006675073 
## health.goodfairly good        health.goodgood                  HHInc 
##           -0.127698999            0.002023967           -1.250802736</code></pre>
</div>
<div id="the-lasso" class="section level4">
<h4>The Lasso</h4>
<p>The lasso model can be estimated in the same way as ridge regression. The <code>alpha = 1</code> parameter tells <code>glmnet()</code> to run lasso regression instead of ridge regression.</p>
<pre class="r"><code>lasso.mod &lt;- glmnet(x[train, ], y[train], alpha = 1, lambda = grid)
plot(lasso.mod)</code></pre>
<p><img src="day6_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Similarly, we can perform cross-validation using identical step as we did in the last exercise on ridge regression.</p>
<pre class="r"><code># cross-validation to pick lambda
set.seed(1)
cv.out &lt;- cv.glmnet(x[train, ], y[train], alpha = 1)
plot(cv.out)</code></pre>
<p><img src="day6_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>bestlam &lt;- cv.out$lambda.min
lasso.pred &lt;- predict(lasso.mod, s = bestlam, newx = x[-train, ])
mean((lasso.pred - y.test)^2)</code></pre>
<pre><code>## [1] 394.6538</code></pre>
<p>We can compare these results with ridge regression by examining the coefficient estimates.</p>
<pre class="r"><code># compare to ridge regression
out &lt;- glmnet(x, y, alpha = 1, lambda = grid)
lasso.coef &lt;- predict(out, type = &quot;coefficients&quot;, s = bestlam)[1:20, ]
lasso.coef</code></pre>
<pre><code>##            (Intercept)             RSexFemale                   RAge 
##            38.33817372             5.56885646            -0.03537519 
##               Househld                    Lab                    SNP 
##             1.04432437            -1.47934921             0.00000000 
##                   Ukip                    BNP                     GP 
##            -0.61403293             5.50747627             0.00000000 
##            party.other                  paper             WWWhourspW 
##             0.00000000             0.11484358             0.00000000 
##              religious           employMonths        urbanmore rural 
##             0.00000000             0.00000000             0.00000000 
##        urbanmore urban             urbanurban        health.goodfair 
##             0.00000000             0.44611691             0.00000000 
## health.goodfairly good        health.goodgood 
##             0.00000000             0.00000000</code></pre>
<pre class="r"><code>lasso.coef[lasso.coef != 0]</code></pre>
<pre><code>## (Intercept)  RSexFemale        RAge    Househld         Lab        Ukip 
## 38.33817372  5.56885646 -0.03537519  1.04432437 -1.47934921 -0.61403293 
##         BNP       paper  urbanurban 
##  5.50747627  0.11484358  0.44611691</code></pre>
</div>
<div id="exercises" class="section level4">
<h4>Exercises</h4>
<div id="q1" class="section level5">
<h5>Q1</h5>
<p>In this exercise, we will predict the number of applications received using the <code>College</code> data set. You need to load <code>libary(ISLR)</code> and then type <code>?College</code> to get the codebook.</p>
<ol style="list-style-type: decimal">
<li>Split the data set into a training set and a test set.</li>
<li>Fit a linear model using least squares on the training set, and report the test error obtained.</li>
<li>Fit a ridge regression model on the training set, with <span class="math inline">\(\lambda\)</span> chosen by cross-validation. Report the test error obtained.</li>
<li>Fit a lasso model on the training set, with <span class="math inline">\(\lambda\)</span> chosen by cross-validation. Report the test error obtained, along with the number of non-zero coefficient estimates.</li>
<li>Comment on the results obtained. How accurately can we predict the number of college applications received? Is there much difference among the test errors resulting from these five approaches?</li>
</ol>
</div>
<div id="q2" class="section level5">
<h5>Q2</h5>
<p>We will now try to predict the per capita crime rate in the <code>Boston</code> data set. The <code>Boston</code> data set is in the <code>MASS</code> library.</p>
<ol style="list-style-type: decimal">
<li>Try out some of the regression methods explored in this chapter, such as best subset selection, the lasso, and ridge regression. Present and discuss results for the approaches that you consider.</li>
<li>Propose a model (or set of models) that seem to perform well on this data set, and justify your answer. Make sure that you are evaluating model performance using validation set error, cross-validation, or some other reasonable alternative, as opposed to using training error.</li>
<li>Does your chosen model involve all of the features in the data set? Why or why not?</li>
</ol>
<pre class="r"><code>detachAllPackages &lt;- function() {
  
  basic.packages &lt;- c(&quot;package:stats&quot;,&quot;package:graphics&quot;,&quot;package:grDevices&quot;,&quot;package:utils&quot;,&quot;package:datasets&quot;,&quot;package:methods&quot;,&quot;package:base&quot;)
  
  package.list &lt;- search()[ifelse(unlist(gregexpr(&quot;package:&quot;,search()))==1,TRUE,FALSE)]
  
  package.list &lt;- setdiff(package.list,basic.packages)
  
  if (length(package.list)&gt;0)  for (package in package.list) detach(package, character.only=TRUE)
  
}
detachAllPackages()

# keep on detaching namespaces
unloadNamespace(&quot;AER&quot;)
unloadNamespace(&quot;car&quot;)
unloadNamespace(&quot;mgcv&quot;)
unloadNamespace(&quot;Amelia&quot;)
unloadNamespace(&quot;pbkrtest&quot;)
unloadNamespace(&quot;lme4&quot;)</code></pre>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
