<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Philipp Broniecki and Lucas Leemann – Machine Learning 1K" />


<title>Lab 2 – Solutions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Essex 2017 Machine Learning</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day1.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D1%20-%20Intro%20ML.pdf">Slides</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day2.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D2%20-%20Intro%20ML.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions2.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day3.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D3%20-%20Classification.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions3.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day4.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D4%20-%20Resampling.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions4.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 5
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day5.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D5%20-%20Model%20Selection%20I.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions5.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 6
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day6.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D6%20-%20Model%20Selection%20II.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions6.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 7
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day7.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D7%20-%20Polynomial%20Models.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions7.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 8
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day8.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D8%20-%20Tree-Based%20Methods.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions8.html">Solutions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Day 9
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="day9.html">Lab</a>
    </li>
    <li>
      <a href="./slides/D9%20-%20Unsupervised%20Learning%20notes.pdf">Slides</a>
    </li>
    <li>
      <a href="solutions9.html">Solutions</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab 2 – Solutions</h1>
<h4 class="author"><em>Philipp Broniecki and Lucas Leemann – Machine Learning 1K</em></h4>

</div>


<div id="solution-lab-2" class="section level3">
<h3>Solution Lab 2</h3>
<ol style="list-style-type: decimal">
<li>Load the immigration dataset dataset</li>
</ol>
<pre class="r"><code># clear workspace
rm(list=ls())

# read in various datasets and combine them 
immi &lt;- read.csv(&quot;http://uclspp.github.io/PUBLG100/data/communities_immig.csv&quot;)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Rename the <code>PctImmigRec5</code> variable to <code>RecentImmigration5</code>.</li>
</ol>
<p>Here, we use <code>select()</code> from <code>dplyr</code>. Sometimes different packages provide packages with similar names. Both <code>dplyr</code> and <code>Zelig</code> have functions called <code>select()</code> for example. This can cause conflicts. If we have a package installed, we can call a function from it directly without loading the function of that package into the current namespace. The following code does this. We also have to merge some data sets.</p>
<pre class="r"><code># load original communities data set
com &lt;- read.csv(&quot;C:/Users/phili/Dropbox/Essex 2017 ML/Day 2/Lab/communities.csv&quot;)

# load data set on employment
empl &lt;- read.csv(&quot;http://uclspp.github.io/PUBLG100/data/communities_employment.csv&quot;)

# merge data sets
# com and empl
com &lt;- merge(com, empl, by = c(&quot;state&quot;, &quot;communityname&quot;))
# merge immi to the data sets
com &lt;- merge(com, immi, by = c(&quot;state&quot;, &quot;communityname&quot;))
# remove the now unecessary data sets immi and empl
rm(immi, empl)

com &lt;- dplyr::select(com,
                     community = communityname,
                     unemploymentrate = PctUnemployed.y,
                     nohighschool = PctNotHSGrad,
                     white = racePctWhite,
                     recentimmigration5 = PctImmigRec5
                     )</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Estimate a model explaining the relationship between unemployment rate and recent immigration over the past 5 years using the variable <code>RecentImmigration5</code>.</li>
</ol>
<pre class="r"><code>m_immi &lt;- lm(unemploymentrate ~ recentimmigration5, data = com)
summary(m_immi)</code></pre>
<pre><code>## 
## Call:
## lm(formula = unemploymentrate ~ recentimmigration5, data = com)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.3772 -0.1461 -0.0397  0.1128  0.6746 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        0.325347   0.008917  36.488  &lt; 2e-16 ***
## recentimmigration5 0.105882   0.021344   4.961 7.62e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.201 on 1992 degrees of freedom
## Multiple R-squared:  0.0122, Adjusted R-squared:  0.01171 
## F-statistic: 24.61 on 1 and 1992 DF,  p-value: 7.621e-07</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Plot the regression line of the model.</li>
</ol>
<p>We draw a scatterplot using the <code>plot()</code> function and <code>abline()</code> to draw the regression line.</p>
<pre class="r"><code># the scatterplot
plot(com$unemploymentrate ~ com$recentimmigration5,
     xlab = &quot;Recent Immigration&quot;,
     ylab = &quot;Unemployment Rate&quot;,
     bty = &quot;n&quot;, pch = 16)

# add the regression line
abline(m_immi, col = &quot;red&quot;, lwd = 2)</code></pre>
<p><img src="solutions2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li>How does this model compare to the models we estimated in the seminar with NoHighSchool and Minority as independent variables? Present your findings by comparing the output of all three models in side-by-side tables using the texreg package.</li>
</ol>
<pre class="r"><code>m_edu &lt;- lm(unemploymentrate ~ nohighschool, data = com)

# minority percentage
com$minority &lt;- 1 - com$white
m_minority &lt;- lm(unemploymentrate ~ minority, data = com)

texreg::screenreg(list(m_edu, m_minority, m_immi))</code></pre>
<pre><code>## 
## =========================================================
##                     Model 1      Model 2      Model 3    
## ---------------------------------------------------------
## (Intercept)            0.08 ***     0.26 ***     0.33 ***
##                       (0.01)       (0.01)       (0.01)   
## nohighschool           0.74 ***                          
##                       (0.01)                             
## minority                            0.43 ***             
##                                    (0.02)                
## recentimmigration5                               0.11 ***
##                                                 (0.02)   
## ---------------------------------------------------------
## R^2                    0.55         0.27         0.01    
## Adj. R^2               0.55         0.27         0.01    
## Num. obs.           1994         1994         1994       
## RMSE                   0.14         0.17         0.20    
## =========================================================
## *** p &lt; 0.001, ** p &lt; 0.01, * p &lt; 0.05</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Save your model comparison table to a Microsoft Word document (or another format if you donâ€™t use Word).</li>
</ol>
<pre class="r"><code>texreg::htmlreg(list(m_edu, m_minority, m_immi), file = &quot;Lab2_model_comparison.doc&quot;)</code></pre>
<pre><code>## The table was written to the file &#39;Lab2_model_comparison.doc&#39;.</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Generate predicted values from the fitted model with RecentImmigration5 and plot the confidence interval using <code>Zelig</code>.</li>
</ol>
<pre class="r"><code>library(Zelig)
z.out &lt;- zelig(unemploymentrate ~ recentimmigration5, data = com, model = &quot;ls&quot;)</code></pre>
<pre><code>## How to cite this model in Zelig:
##   R Core Team. 2007.
##   ls: Least Squares Regression for Continuous Dependent Variables
##   in Christine Choirat, Christopher Gandrud, James Honaker, Kosuke Imai, Gary King, and Olivia Lau,
##   &quot;Zelig: Everyone&#39;s Statistical Software,&quot; http://zeligproject.org/</code></pre>
<pre class="r"><code>x.out &lt;- setx(z.out, recentimmigration5 = seq(0, 1, 0.1))
s.out &lt;- sim(z.out, x = x.out, n=10000)</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Save all the plots as graphics files.</li>
</ol>
<pre class="r"><code>png(&quot;plot.png&quot;)
ci.plot(s.out, xlab = &quot;Recent Immigration (last 5 years)&quot;, ci = 95)
dev.off()</code></pre>
<pre><code>## png 
##   2</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
